<div class="wrapper-modal" *ngIf="!loading && detalle; else cargandoTpl">
  <div class="icon-close">
    <button class="btn" (click)="cerrar()">
      <i class="bi bi-x-lg"></i>
    </button>
  </div>

  <div class="body-modal">
    <h1 class="title-modal">Expediente clínico</h1>

    <!-- Resumen -->
    <div class="field">
      <span class="label">Paciente:</span>
      <span class="value">{{ detalle.paciente }}</span>
    </div>

    <div class="field">
      <span class="label">Matrícula:</span>
      <span class="value">{{ detalle.matricula || '—' }}</span>
    </div>

    <div class="field">
      <span class="label">Médico principal:</span>
      <span class="value">{{ detalle.medico || '—' }}</span>
    </div>

    <div class="field">
      <span class="label">Especialidad:</span>
      <span class="value">{{ detalle.especialidad || '—' }}</span>
    </div>

    <div class="field">
      <span class="label">Última cita:</span>
      <span class="value">
        {{ detalle.ultima_cita || 'Sin citas registradas' }}
      </span>
    </div>

    <div class="field">
      <span class="label">Total de citas:</span>
      <span class="value">{{ detalle.total_citas }}</span>
    </div>

    <!-- Historial de citas -->
    <div class="mt-3" *ngIf="detalle.citas && detalle.citas.length > 0">
      <h2 class="subtitle-modal">Historial de citas</h2>

      <table class="table table-sm table-striped table-hover">
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Hora</th>
            <th>Médico</th>
            <th>Especialidad</th>
            <th>Motivo</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let c of detalle.citas">
            <td>{{ c.fecha }}</td>
            <td>{{ c.hora }}</td>
            <td>{{ c.medico }}</td>
            <td>{{ c.especialidad }}</td>
            <td>{{ c.motivo }}</td>
            <td>{{ c.estado }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="buttons-modal">
      <button mat-button class="btn-cerrar" (click)="cerrar()">
        Cerrar
      </button>
    </div>
  </div>
</div>

<ng-template #cargandoTpl>
  <div class="wrapper-modal">
    <div class="body-modal text-center">
      Cargando expediente...
    </div>
  </div>
</ng-template>
